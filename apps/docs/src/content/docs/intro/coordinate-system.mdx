---
title: Coordinate System
description: Understanding the coordinate system used in ngDiagram
sidebar:
  order: 2
---

import CodeSnippet from '@components/code-snippet/code-snippet.astro';
import CodeViewer from '@components/code-viewer/code-viewer.astro';
import NgDiagramComponentContainer from '../../../components/angular/coordinate-system/coordinate-system.astro';

NgDiagram uses a coordinate system that enables precise positioning of all diagram elements. Understanding this system is crucial for creating accurate diagrams and implementing custom behaviors.

## Diagram Origin

The diagram has a **global coordinate system** with its origin at the top-left corner of the diagram container. This origin serves as the reference point for all positioning calculations.

### Key Characteristics

- **Origin Point**: (0, 0) is located at the top-left corner of the diagram container
- **Positive X**: Moving the viewport to the right increases values
- **Positive Y**: Moving the viewport down increases values
- **Units**: All coordinates are in pixels
- Negative values are supported

> In other words, as you drag the diagram right or down, the coordinates of elements increase along the X and Y axes.

## Element Positioning

### Nodes

Nodes are positioned using **absolute coordinates** relative to the diagram origin:

<CodeSnippet relativePath="coordinate-system/diagram.component.ts" sectionId="element-positioning-nodes" />

**Positioning Behavior:**

- The [`position`](/docs/api/types/model/simplenode#position) property defines the top-left corner of the node
- Nodes are positioned using CSS `transform: translate(x, y)`
- Position is independent of the node's size or content

### Ports

Ports have **absolute positioning** within their parent node:

**Default Side Positioning:**

- **Left side**: `top: 50%, left: 0` (center of left edge)
- **Right side**: `top: 50%, left: 100%` (center of right edge)
- **Top side**: `top: 0, left: 50%` (center of top edge)
- **Bottom side**: `top: 100%, left: 50%` (center of bottom edge)

**Custom Positioning:**
Ports can be positioned anywhere within the node using CSS properties:

```html
<ng-diagram-port id="custom-port" type="target" side="left" style="top: 25%; left: 0" />
```

### Groups

Groups follow the same positioning rules as regular nodes:

<CodeSnippet relativePath="coordinate-system/diagram.component.ts" sectionId="element-positioning-groups" />

**Group Behavior:**

- Groups are positioned the same as nodes - at their top-left corner
- Child nodes within groups retain their global positions - their coordinates are not recalculated or adjusted when added to a group
- When a group moves, all its children move with it

### Edge Labels

Edge labels are positioned using **absolute coordinates** along the edge path:

```typescript
{
  id: 'label1',
  positionOnEdge: 0.5, // 50% along the edge path (0 = start, 1 = end)
  position: { x: 0, y: 0 }, // Absolute position relative to viewport's origin (calculated automatically)
  // ... other properties
}
```

**Label Positioning:**

- [`positionOnEdge`](/docs/api/types/model/edgelabel#positiononedge): Value from 0 to 1 indicating position along the edge
- [`position`](/docs/api/types/model/edgelabel#position): Absolute coordinates calculated by the system
- Labels are positioned using `transform: translate(x, y) translate(-50%, -50%)` for center alignment

## Viewport and Scaling

### Viewport Coordinates

The viewport represents the visible area of the diagram:

<CodeSnippet relativePath="coordinate-system/diagram.component.ts" sectionId="viewport-coordinates" />

### Coordinate Transformations

The [`NgDiagramViewportService`](/docs/api/services/ngdiagramviewportservice) offers methods for converting between different coordinate systems in ngDiagram:

**Client to Flow Position:**

```typescript
// Convert screen coordinates to diagram coordinates
const flowPosition = viewportService.clientToFlowPosition({ x: 150, y: 200 });
```

**Flow to Client Position:**

```typescript
// Convert diagram coordinates to screen coordinates
const clientPosition = viewportService.flowToClientPosition({ x: 100, y: 150 });
```

### Reading Viewport Data

Use the [`NgDiagramViewportService`](/docs/api/services/ngdiagramviewportservice) to access viewport information reactively:

<CodeSnippet relativePath="/coordinate-system/preview/coordinates.component.ts" sectionId="coordinates-component" />

**Available Viewport Properties:**

- [`x`](/docs/api/types/model/viewport#x), [`y`](/docs/api/types/model/viewport#y): Current pan offset
- [`scale`](/docs/api/types/model/viewport#scale): Current zoom level
- [`width`](/docs/api/types/model/viewport#width), [`height`](/docs/api/types/model/viewport#height): Viewport dimensions

<br />

<NgDiagramComponentContainer />
<CodeViewer dirName="coordinate-system" />
