# NgDiagram Docs

## How to work with Starlight

### Getting Started

Run `pnpm install` and `pnpm docs:dev` to start the development server.

If you wanna check out the preview (i.e. to see how search works), run `pnpm -F docs build` and `pnpm -F docs preview`

Make sure you know the tech you'll be working with:

- [Astro](https://docs.astro.build/en/basics/astro-pages/) - the base of Starlight framework
- [MDX](https://mdxjs.com/) - a markdown extension for JSX
- [@analogjs/astro-angular](https://analogjs.org/docs/packages/astro-angular/overview) - Angular integration for Astro

### Starlight Features

- [Markdown](https://starlight.astro.build/guides/authoring-content/) - about frontmatter and what you can do with it
- [Sidebars](https://starlight.astro.build/guides/sidebar/) - how sidebars are autogenerated from file structure
- [Components](https://starlight.astro.build/components/using-components/) - many UI goodies from Starlight for visually appealing articles
- [Plugins](https://starlight.astro.build/resources/plugins/) - extend Starlight with custom functionality

### Components for presenting code

#### ExampleViewer

To display comprehensive code examples with many files create a directory in `./src/components/angular/examples/$DIR_NAME` and place your code files there. Then use `<ExampleViewer dirName={$DIR_NAME} />`. It will automatically display the code examples except for the `.astro` files.

You still need to create the `.astro` component to display the angular components and import it manually into and `.mdx` documentation.

_Example_

```
// custom-node.mdx

import CustomNode from '@examples/custom-node/custom-node.astro';
import ExampleViewer from '@components/example-viewer/example-viewer.astro';

<CustomNode />

<ExampleViewer dirName="custom-node" />
```

#### CodeSnippet

`<CodeSnippet />` is a wrapper on top of the `<Code />` component from Astro. It's using Expressive Code library providing many ways to present code snippets in a user-friendly way. Thanks to its plugin system you can easily add new features.

#### Code Highlighting

Both `<ExampleViewer />` and `<CodeSnippet />` support highlighting the code snippets for easier comprehension and readability. This feature is using `<Code />` component provided by Starlight and is using Expressive Code library. Check `ec.config.js` too see how it's configured.

`<Code />` enables code highlighting by passing props such as `mark`, `collapse` etc. Tracking the changes of highlighted lines is really tricky with this approach. To avoid this issue `<HighlightedCode />` was created to extract the highlights directly from the code snippet source using special comments.

To keep the example code working properly use native comment syntax for appropriate lines:

- `// @example` for Typescript code
- `/* @example */` for CSS
- `<!-- @example -->` for HTML and Angular templates
  All comments that start with a supported keyword will be removed from the final output.

##### Sections

Adding `sectionId` to the comment will highlight the code snippet in the specified section.

Syntax: `// @section-(start|end):sectionId`

If there's only one section in a file, the `sectionId` is optional. It also applies for other special comments like `@mark`
Passing `sectionId` to `<ExampleViewer />` or `<CodeSnippet />` will highlight the code snippet in the specified section. Otherwise, the entire snippet or the only section will be highlighted.

##### Mark Substring

Highlights all occurences of a given substring.

Syntax: `@mark:keyword:sectionId`

##### Mark (Range)

Highlights all lines in a given range.
Passing `sectionId` will highlight the code only when appropriate `sectionId` was provided to `<ExampleViewer />` or `<CodeSnippet />`.

Syntax: `@mark-(start|end):sectionId`

##### Collapse (Range)

Collapses all lines in a given range.
Passing `sectionId` will collapse the code only when appropriate `sectionId` was provided to `<ExampleViewer />` or `<CodeSnippet />`.

Syntax: `@collapse-(start|end):sectionId`

##### Limitations

- It's not possible to use ranged comment within the same element tag in Angular templates.

Example:

```
  <ng-diagram
    <!-- @mark-start -->
    [model]="model"
    <!-- @mark-end -->
  >
  </ng-diagram>
```

### Autogenerated API Docs

Our API documentation is automatically generated from TSDoc comments in the source code. To ensure high-quality documentation, follow these guidelines when writing TSDoc comments.

#### Using @category for Organization

The `@category` tag is crucial for organizing API documentation into logical groups. It determines how entities are grouped in the generated documentation sidebar and sections.

**Common categories in our codebase:**

- `@category Components` - Angular components (NgDiagramComponent, etc.)
- `@category Directives` - Angular directives (CursorPositionTrackerDirective, etc.)
- `@category Types` - Type definitions and interfaces
- `@category Middlewares` - Middleware implementations

```typescript
/**
 * Primary diagram component for rendering interactive flow diagrams.
 * @category Components
 */
@Component({...})
export class NgDiagramComponent { }
```

#### Essential TSDoc Tags

**Core Documentation:**

- `@param {type} name - description` - Document method parameters
- `@returns description` - Document return values
- `@throws description` - Document exceptions that may be thrown

**Enhanced Documentation:**

- `@example` - Provide code examples (multiple allowed)
- `@see {@link Reference}` - Cross-reference related items
- `@since version` - Version when feature was added
- `@deprecated` - Mark deprecated APIs

**API Metadata:**

- `@public` / `@internal` - API visibility
- `@readonly` - Immutable properties
- `@override` - Overridden methods
- `@beta` / `@alpha` - API stability indicators

#### Best Practices

1. **Always use @category** - Every exported class, interface, or function should have a category
2. **Provide examples** - Include practical code examples for complex APIs
3. **Cross-reference related items** - Use @see to link related components/types
4. **Document edge cases** - Explain behavior with null/undefined inputs
5. **Keep descriptions clear** - Start with what the item does, then explain how/why
6. **Use consistent terminology** - Match naming conventions used in the codebase

### Recommendations and Tips

#### .not-content class

Use `.not-content` class to avoid default Starlight styles leaking into your content (i.e. NgDiagram components)

#### ng-diagram debug mode

Use `[debugMode]="true"` for `ng-diagram` component to enable debug.

#### Using Angular components

Add new components to `./src/components/angular/*` if you want to use them in `mdx` files. Files are built directly from that path.

#### Module aliases

Check tsconfig.json for aliases that you can use to import modules more easily.
